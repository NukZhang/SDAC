# 🧠 AI 自我裁决模式（违规 → 自动回滚）

## 定位
本模式用于在 AI 执行过程中 **自动发现违规、判定严重性、回滚并重跑**，
避免人类反复解释需求或手动纠偏。

本机制必须在 **总 SKILL 已启用** 的前提下使用。

---

## 一、触发条件（任一满足即触发）

- AI 完成一次输出（分析 / 代码 / 结果）
- 人类显式指令：  
  > 启用 AI 自我裁决模式

---

## 二、自我裁决执行流程（强制顺序）

### Step 1：冻结当前输出
- 当前输出视为“候选结果”
- 不得继续扩展或补充功能

---

### Step 2：执行《Skill 违规检测 Checklist》

- 必须逐条自检：
  - Spec 级
  - 流程级
  - 子 Skill 级
  - 技术约束
  - AI2AI 记录

---

### Step 3：违规分级判定

#### A 级违规（致命）
- 任意 Spec 级违规
- 跨迭代
- 引入 Me2AI 未定义需求

#### B 级违规（严重）
- 提前抽象
- 子 Skill 职责越界
- 执行流程不完整

#### C 级违规（轻微）
- 命名 / 结构不一致
- 可删除的冗余实现

---

### Step 4：自动裁决策略

- **A 级违规**
  - 丢弃全部当前结果
  - 回滚到“迭代开始前状态”
  - 重新执行当前迭代（最小实现）

- **B 级违规**
  - 删除违规代码
  - 回退到最小可完成集
  - 不新增任何内容

- **C 级违规**
  - 就地修正
  - 不影响已验证功能

---

### Step 5：重跑与再校验

- 修正 / 重跑后
- 必须再次完整执行 Checklist
- 若仍存在违规 → 继续回滚

---

## 三、AI2AI.md 写入规范（强制）

每次触发自我裁决，必须在 AI2AI.md 中记录：

```md
### 自我裁决记录
- 触发原因：
- 违规等级：
- 回滚策略：
- 最终结果：
```

---

## 四、最小 Prompt 启用模板（推荐）

### 模式 1：自动（默认）

```md
在提交最终结果前，
你必须启用 AI 自我裁决模式，
通过《Skill 违规检测 Checklist》，
若存在违规，自动回滚并修正。
```

### 模式 2：强制回滚

```md
启用 AI 自我裁决模式，
若发现 A / B 级违规，
必须回滚并重新执行当前迭代。
```

---

## 五、设计原则（给人类）

- 不讨论“好不好”
- 不与 AI 争论设计
- 只接受 **通过裁决后的结果**

---

## 六、禁止事项

- 裁决过程中引入新需求
- 以修复为由扩展功能
- 跳过 Checklist
- 跳过 AI2AI 记录

---

## 七、一句话定义

> **AI 自我裁决模式 = 把“代码评审 + 回滚决策”内化为 AI 的强制行为**
